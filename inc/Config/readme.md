# Config Class

The `Config` class collates basic information about the plugin, including text domain, and configuration details, and relies heavily on `get_plugin_data()` to gather header details found in the [docblock in the plugin root file](https://codex.wordpress.org/File_Header). The `Config` class accepts one parameter, which is the path to the plugin root, ie the value of `__FILE__ ` of the plugin root class.
As `get_plugin_data()` involves a file system read to parse the plugin's docblock, this class is best instantiated once and then passed using dependency injection.

If created in the my-plugin.php root file, a new instance of `Config` can be created by passing a reference to the root WordPress plugin file:

```php
use \Ran\PluginLib\Config;

$config = new Config(__FILE__);

print_r $config->plugin_array;
```

## Minimum headers & derived values

Our `Config` class, collates environment information from various sources and puts them in one convent place. These sources include WordPress methods such as `plugin_dir_path()`, and `get_plugin_data()` which parses the root plugin docblock. As PluginLib relies on additional fields, the WordPress minimum headers requirements have been expanded to include the following:

    /*
     * Plugin Name
     * Description
     * Version
     * Plugin URI
     * Update URI
     * Requires at least: (^6.1.0)
     * Requires PHP: (^8.1.0)
     * Author
     * Author URI
     * License
     * Text Domain (optional|derived)
     * Domain Path: /lang
    */

These values and more generated by WordPress and our Plugin class can be found in the `readonly` parameter `Plugin::plugin_array`.

## Plugin class methods and properties

### readonly: `Config::plugin_array`

`plugin_array` is a readonly property which holds useful details, including ones inferred from the environment and derived from the WordPress plugin header docblock:

     ['Name'] The name of the plugin (declared as 'Plugin Name' in headers).
     ['Version'] The version of the plugin.
     ['Description'] The description of the plugin.
     ['PluginURI'] The project URI for the plugin.
     ['UpdatesURI] The plugin updates URI, not required if hosted on the WP Plugin Directory. [See Announcement](https://make.wordpress.org/core/2021/06/29/introducing-update-uri-plugin-header-in-wordpress-5-8/)
     ['Title'] (derived) The title of the plugin rendered as a link pointing to the plugin URI.
     ['FileName'] (derived) The file name of the root plugin file.
     ['URL'] (derived) URL to the plugin's containing direcotory within WordPress.
     ['PATH'] (derived) Full file path to the plugin's containing directory.

     ['Author']  The author of the plugin.
     ['AuthorURI'] The author's webpage URI.
     ['AuthorName'] (derived) The author of the plugin rendered as a link pointing to the author URI.
     ['TextDomain'] (optional|derived) [The text domain of the plugin, used as the plugin slug in urls, in lower-kebab-case](https://developer.wordpress.org/plugins/internationalization/how-to-internationalize-your-plugin/#text-domains).
     ['DomainPath'] [A realitive path to language translation files. Defaults to '/lang'](https://developer.wordpress.org/plugins/internationalization/how-to-internationalize-your-plugin/#domain-path).
     ['PluginOption'] (derived) The name of the plugin in the WP options table, which is auto generated from the text domain in lower_snake_case.
     ['RequiresPHP'] The required PHP version of the plugin.
     ['RequiresWP'] The required Wordpress version for this plugin.

> Note:
>
> -   Your output may also include valid additional [plugin header](https://developer.wordpress.org/plugins/plugin-basics/header-requirements/) options.
> -   Array keys in CamelCase represent space separated DockBlock names, with exception of "Name" which is identified as "Plugin Name" in the docblock.

#### `Config::plugin_array` derived values

Details on how `plugin_array` derived values are generated:

-   `['PATH']` Derived from the return value of `plugin_dir_path( dirname( __FILE__, 5 ) )`
-   `['URL']` Derived from the return value of `plugin_dir_path( dirname( __FILE__, 5 ) )`
-   `['FileName']` Derived from the return value of `plugin_basename( $plugin_file )`, where `$plugin_file` is the path to the root plugin file passed to the Plugin constructor on instantiation.
    -   The `Plugin` class is most often instantiated in the plugin root so the magic constant `__FILE__` is typically passed.
-   `['Title']` An HTML string link to the plugin homepage, derived by WordPress from `Plugin Name` and `Description`.
-   `['PluginOption']` The name of the plugin in the WP options table, which is auto generated from the `Text Domain` converted to `lower_snake_case`. _At the time of writing, this value cannot be overridden._
-   `['Author']` An HTML string link to the author homepage derived from `Author Name` and `Author URI`.
-   `['TextDomain']` As of WordPress 4.6, this required value will be automatically generated using the containing plugin directory name, as it is also the plugin's slug in url's. If you wish a different value then the directory name, it may be set here in `lower-kebab-case`. [WP Docs](https://developer.wordpress.org/plugins/internationalization/how-to-internationalize-your-plugin/#text-domains)

### `Config::validate_plugin_array($plugin_array)`

The `validate_plugin_array()` method accepts an array and checks that a minimum list of required headers and generated values are present as keys on the array. By default, the required entries include:

    'Name',
    'Version',
    'PluginURI',
    'Author',
    'PluginOption',
    'TextDomain',
    'DomainPath',
    'RequiresPHP',
    'RequiresWP',

> Note: `validate_plugin_array()` does not validate the structure of the header values, only that required values are present as keys on the array.

### `get_wp_options()`

The `get_wp_options()` method returns the value of the current plugins primary WordPress option, or `false` if none has been set.
